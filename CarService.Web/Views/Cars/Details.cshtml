@model DetailsVM
@{
    ViewBag.Title = "Details";
}

<style>
    .green {
        background-color: #d4edda;
        color: #155724;
        padding: 5px;
        border-radius: 3px;
    }

    .yellow {
        background-color: #fff3cd;
        color: #856404;
        padding: 5px;
        border-radius: 3px;
    }

    .red {
        background-color: #f8d7da;
        color: #721c24;
        padding: 5px;
        border-radius: 3px;
    }
</style>

<header>
    <h1>Details</h1>
    <section>
        <a href='@Url.Action("Index", "Cars")'>Home</a>
    </section>
    <a asp-controller="Cars"
       asp-action="AddItem"
       asp-route-id=@Model.Id>
        Add new service item
    </a>
</header>
<main>
    <section class="my-4">
        <h2 class="mb-3">Car Information</h2>
        <div class="card shadow-sm">
            <div class="card-body">
                <dl class="row mb-0">
                    <dt class="col-sm-3">Brand</dt>
                    <dd class="col-sm-9">@Model.Brand</dd>

                    <dt class="col-sm-3">Model</dt>
                    <dd class="col-sm-9">@Model.Model</dd>

                    <dt class="col-sm-3">Year</dt>
                    <dd class="col-sm-9">@Model.Year</dd>

                    <dt class="col-sm-3">Engine Type</dt>
                    <dd class="col-sm-9">@Model.EngineType</dd>

                    <dt class="col-sm-3">Trip Meter</dt>
                    <dd class="col-sm-9">@Model.TripMeter</dd>
                </dl>
            </div>
        </div>
    </section>

    <section>
        <h2 class="h5 mb-3">Service interval information</h2>

        <div class="accordion" id="accordionExample">
            @for (int i = 0; i < Model.serviceItemsVM.Length; i++)
            {
                var item = Model.serviceItemsVM[i];

                var statusClass = item.Status switch
                {
                    ServiceStatusVM.Ok => "bg-success bg-opacity-10",
                    ServiceStatusVM.Due => "bg-warning bg-opacity-10",
                    ServiceStatusVM.Overdue => "bg-danger bg-opacity-10",
                    _ => ""
                };

                var collapseId = $"collapse{i}";
                var headingId = $"heading{i}";
                var showClass = i == 0 ? "show" : "";
                var collapsedClass = i == 0 ? "" : "collapsed";
                var expanded = i == 0 ? "true" : "false";

                <div class="accordion-item mb-2 border rounded">
                    <h2 class="accordion-header" id="@headingId">
                        <button class="accordion-button @collapsedClass @statusClass" type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#@collapseId"
                                aria-expanded="@expanded"
                                aria-controls="@collapseId">
                            @item.Name (@item.Status)
                        </button>
                    </h2>
                    <div id="@collapseId" class="accordion-collapse collapse @showClass" aria-labelledby="@headingId" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <p><strong>Description:</strong> @item.Description</p>
                            <p><strong>Last service:</strong> @item.LastService.ToShortDateString()</p>
                            <p><strong>Change every:</strong> @item.KmInterval km or @item.TimeIntervalMonths months.</p>
                        </div>
                    </div>
                </div>

            }
        </div>
    </section>

@*     <section>

        <h2>Service interval information</h2>

        <ol>
            @foreach (var item in Model.serviceItemsVM)
            {

                var statusClass = item.Status switch
                {
                    ServiceStatusVM.Ok => "green",
                    ServiceStatusVM.Due => "yellow",
                    ServiceStatusVM.Overdue => "red",
                    _ => ""
                };


                <li class="@statusClass">
                    <p><strong>@item.Name</strong></p>
                    <p><strong>Description: </strong>@item.Description</p>
                    <p><strong>Last service: </strong>@item.LastService.ToShortDateString()</p>
                    <div>
                        <p><strong>Change every: </strong>@item.KmInterval km or @item.TimeIntervalMonths months.</p>
                    </div>
                </li>
            }
        </ol>

    </section> *@

</main>

